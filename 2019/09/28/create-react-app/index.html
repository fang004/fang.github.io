<!-- build time:Sat Sep 28 2019 02:34:18 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><title>create-react-app | 赵芳</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/styles.css"><link rel="shortcut icon" href="/2019/09/28/create-react-app/index.html"></head></html><body class="te-body-default"><div class="te-wrap" id="teWrap"><div class="te-left"><div id="menu-outer"><div id="menu-inner"><div class="te-menu-item"><a href="/"><span>赵芳</span></a></div><div class="te-menu-item"><a href="/archives"><span>所有文章</span></a></div><div class="te-menu-item"><a href="https://github.com/fang004"><span>Github</span></a></div></div></div></div><div class="te-right"><div id="content-outer"><div id="content-inner"><article id="post"><h1 class="post-title">create-react-app</h1><div class="toc-show" id="tocShow"><i class="fa fa-navicon"></i></div><a class="go-top" href="#teWrap" id="goTop"><i class="fa fa-arrow-up"></i></a><div class="te-post-outer"><div class="te-post-inner"><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><pre><code>npm install -g create-react-app
</code></pre><h1 id="创建react应用"><a href="#创建react应用" class="headerlink" title="创建react应用"></a>创建react应用</h1><pre><code class="node">create-react-app react-cli-demo
</code></pre><p>命令中的<code>react-cli-demo</code>，是需要创建的文件夹，可以是文件夹，或者文件夹的相对地址、绝对地址。</p><ol><li><p>文件夹</p><blockquote><p>示例：在当前目录下，创建一个叫<code>hello-react</code>的文件夹，并初始化<code>react</code>应用<br><code>create-react-app hello-react</code></p></blockquote></li></ol><ol start="2"><li><p>相对路径</p><blockquote><p>示例一：在当前目录父级，创建一个叫<code>hello-react</code>的文件夹，并初始化<code>react</code>应用<br><code>create-react-app ../hello-react</code></p></blockquote><blockquote><p>示例二：和第1点一样，在当前目录下，创建一个叫<code>hello-react</code>的文件夹，并初始化<code>react</code>应用<br><code>create-react-app ./hello-react</code></p></blockquote></li><li><p>绝对路径</p><blockquote><p>示例一：在当前用户的<code>Downloads</code>文件夹下，创建一个叫<code>hello-react</code>的文件夹，并初始化<code>react</code>应用<br><code>create-react-app ~/Downloads/hello-react</code></p></blockquote><blockquote><p>示例二：使用以下方式，也可以在同样的目录下，创建一个叫<code>hello-react</code>的文件夹，并初始化<code>react</code>应用。(<code>zhaofang</code>替换成实际的用户目录)<br><code>create-react-app /Users/zhaofang/Downloads/hello-react</code></p></blockquote></li></ol><h2 id="1-主要依赖"><a href="#1-主要依赖" class="headerlink" title="1. 主要依赖"></a>1. 主要依赖</h2><pre><code>react,react-dom,react-scripts
</code></pre><p>见<a href="https://github.com/facebook/create-react-app/blob/master/packages/create-react-app/createReactApp.js" target="_blank" rel="noopener">源码</a>：386行</p><p>如何定位到这行，在下面的章节会简单介绍下调试方法</p><p><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.04.09.jpg" alt="源码"></p><h2 id="2-生成的目录结构"><a href="#2-生成的目录结构" class="headerlink" title="2. 生成的目录结构"></a>2. 生成的目录结构</h2><p><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.03.36.jpg" alt="源码"></p><h2 id="3-package-json"><a href="#3-package-json" class="headerlink" title="3. package.json"></a>3. <code>package.json</code></h2><p>短短的31行，就是这么的牛叉</p><p><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.32.50.jpg" alt="源码"></p><h1 id="npm命令"><a href="#npm命令" class="headerlink" title="npm命令"></a><code>npm</code>命令</h1><h2 id="react-scripts"><a href="#react-scripts" class="headerlink" title="react-scripts"></a><code>react-scripts</code></h2><p>一共4个命令，怎么都是<code>react-scripts</code>开头，这是个啥？？。</p><p><img src="/2019/09/28/create-react-app/doubt.jpg" alt="这是个啥？？]"></p><p>有问题怎么办，上<code>github</code>。</p><p>咱们还是回到<code>github</code>上继续的找</p><ol><li>打开文件目录，点开g<a href="https://github.com/facebook/create-react-app/tree/master/packages" target="_blank" rel="noopener">create-react-app项目的packages文件夹</a>。</li><li>可以看到一共有9个依赖包，他们都是应<code>create-react-app</code>而生的。其中就是咱们要找的<code>react-scripts</code></li></ol><p><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.36.04.jpg" alt="packages"></p><ol start="3"><li>想要了解具体的原理，可以深入看<a href="https://github.com/facebook/create-react-app/tree/master/packages/react-scripts" target="_blank" rel="noopener"><code>react-scripts</code>项目文件</a>，我们这里就不一一展开了。</li></ol><p>直接上总结吧。</p><p>使用<code>create-react-app</code>工具创建<code>react</code>项目，主要就2个包。</p><ol><li><code>create-react-app</code>：全局的命令行工具，用这个命令来创建新的项目。</li><li><code>react-scripts</code>：生成的项目所需要的开发依赖。<ul><li>一般咱们开始创建<code>web</code>应用时，会有以下的操作：<ul><li>通过<code>yarn</code>或者<code>npm</code>安装全部依赖。</li><li>写<code>webpack.config.js</code></li><li>其他一系列复杂的配置</li><li>搭建本地服务，热更、打包配置等等……</li></ul></li><li>有了<code>react-scripts</code>后，可以不用再写这些配置，它全干了，你只需要在<code>package.json</code>中用它就行了，有了它小白也可以10分钟搭1个<code>Hello React</code>的<code>React</code>项目。它把你从繁琐、重复的配置中解放出来，让你专心写<code>src</code>源代码。</li></ul></li></ol><h2 id="npm-start"><a href="#npm-start" class="headerlink" title="npm start"></a><code>npm start</code></h2><ul><li>项目启动</li><li>自动帮你创建端口，编辑代码，打开浏览器查看，热更新。<h2 id="npm-run-build"><a href="#npm-run-build" class="headerlink" title="npm run build"></a><code>npm run build</code></h2></li><li>这个咱不陌生，把你的代码打包编译成静态文件，直接丢到服务器上</li></ul><p><strong>【注意注意】这个生成的目录，是<code>/build</code></strong></p><p>为啥要特别说明呢，因为我平时的习惯都是把<code>node</code>脚本文件，放在<code>build</code>下，而打包后的，放在<code>dist</code>上面。</p><p>然后呢，因为<code>create-react-app</code>把编译后的放在<code>build</code>下面，然后在<code>.gitignore</code>文件里面，配置了<code>/build</code>。</p><p>马大哈的我，根本就没注意，辛辛苦苦写的脚本，一朝<code>npm run build</code>，全不见了历史提交记录也没有，因为被<code>gitignore</code>了。</p><p><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.51.03.jpg" alt="我太难了"></p><h2 id="npm-run-test"><a href="#npm-run-test" class="headerlink" title="npm run test"></a><code>npm run test</code></h2><ul><li>运行测试功能</li><li>脚手架使用的<code>jest</code>为测试工具，使用<code>jest</code>做单元测试</li><li>测试用例放在<code>src</code>目录下<ul><li><code>__tests__</code>目录下的<code>.js</code>文件</li><li>后缀<code>.test.js</code>文件</li><li>后缀<code>.spec.js</code>文件</li></ul></li><li>当你运行这个命令时，<code>jest</code>会开启<code>watch</code>模式，一旦保存文件，就会重新更新</li></ul><h2 id="npm-run-eject"><a href="#npm-run-eject" class="headerlink" title="npm run eject"></a><code>npm run eject</code></h2><ul><li>这个，就是为了高阶定制而生的</li><li>单向操作不可逆</li><li>解压默认的webpack配置到配置文件中，涉及到的文件超级多<br><img src="/2019/09/28/create-react-app/much.gif" alt="超级多"></li><li><code>package.json</code>满满当当的依赖，简洁的代码，变成了曾经</li><li>还有随之而来的<code>scripts</code>，及<code>config</code>目录，特别是<code>config</code>，里面有你曾经看到的<code>webpack.config.js</code>,<code>webpackDevServer.config.js</code>等。</li></ul><h1 id="end"><a href="#end" class="headerlink" title="end"></a>end</h1><p>就是本期到此为止的意思。</p><p>有兴趣的也可以看看下面，实操的小结。</p><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="本地调试create-react-app"><a href="#本地调试create-react-app" class="headerlink" title="本地调试create-react-app"></a>本地调试<code>create-react-app</code></h2><h3 id="查找create-react-app的位置"><a href="#查找create-react-app的位置" class="headerlink" title="查找create-react-app的位置"></a>查找<code>create-react-app</code>的位置</h3><p>在终端中，使用<code>which</code>命令查找包所在的位置</p><pre><code class="node">which create-react-app
##我的包位置 /Users/zhaofang/.nvm/versions/node/v10.16.3/bin//create-react-app
</code></pre><h3 id="找到实际位置"><a href="#找到实际位置" class="headerlink" title="找到实际位置"></a>找到实际位置</h3><ol><li>打开上一步地址中<code>//</code>前的目录</li><li>右键选择“显示原生”</li><li>当前打开的目录，在终端中执行<code>create-react-app</code>命令，调用的包。<br><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.14.50.jpg" alt="源码"><br>我本地的地址：<code>/Users/zhaofang/.nvm/versions/node/v10.16.3/lib/node_modules/create-react-app/</code></li></ol><h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><ol><li>打开项目：</li></ol><ul><li>用你平时的开发工具（我用的vs code），打开上一步获得的包目录</li></ul><ol start="2"><li>查看入口：</li></ol><ul><li>一般都是<code>package.json</code>文件。</li><li>查看文件<code>package.json</code>，找到<code>bin.create-react-app</code>命令所执行的文件<code>./index.js</code></li><li><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.19.47.jpg" alt="package.json"></li></ul><ol start="3"><li>查看依赖：</li></ol><ol><li>用你平时的开发工具（我用的vs code），打开上一步获得的包目录</li><li>打开文件：当前目录下的<code>index.js</code>，这个文件特别短，一看就知道不是具体的逻辑，咱们看54行引用的包<code>require(&#39;./createReactApp&#39;);</code>。</li><li><img src="/2019/09/28/create-react-app/screenshot_2019-09-27PM6.20.02.jpg" alt="index.js"></li><li><p>打开文件：当前目录下的<code>createReactApp.js</code>，969行，看着像是逻辑了。查找暂时到此为止。如果当前文件还是特别短，咱再看引用了哪些文件，继续按照这样的方法查找。</p></li><li><p>调试</p></li></ol><ul><li>在你想要了解的代码段，打console.log来输入想要知道的变量。</li><li>终端中输入<code>create-react-app</code>命令（比如咱之前的安装<code>create-react-app hello-react</code>命令），查看终端中的log日志。</li><li>你现在就可以对着这个目录，随意的增改代码，看实际的输出即表现。</li><li>简易调度方法到此为止。</li></ul><h2 id="安装中碰到的问题"><a href="#安装中碰到的问题" class="headerlink" title="安装中碰到的问题"></a>安装中碰到的问题</h2><h3 id="巨卡"><a href="#巨卡" class="headerlink" title="巨卡"></a>巨卡</h3><p>这时候祭出祖传的<a href="https://npm.taobao.org/" target="_blank" rel="noopener">淘宝NPM镜像</a>，具体操作有2种方法。</p><h4 id="1-终端换源"><a href="#1-终端换源" class="headerlink" title="1. 终端换源"></a>1. 终端换源</h4><pre><code>//换源
npm config set registry https://registry.npm.taobao.org
//配置后通过以下方法验证是否成功
npm config get registry
registry=https://registry.npm.taobao.org
</code></pre><h4 id="2-配置-npmrc文件，一捞永逸，懒人的福音"><a href="#2-配置-npmrc文件，一捞永逸，懒人的福音" class="headerlink" title="2.配置.npmrc文件，一捞永逸，懒人的福音"></a>2.配置<code>.npmrc</code>文件，一捞永逸，懒人的福音</h4><p>以下2种方式都可以操作文件，在文件最下面中加上新行<code>registry=https://registry.npm.taobao.org</code>。</p><ol><li>终端中输入命令<code>vim ~/.npmrc</code>，编辑并保存</li><li>打开<code>~</code>文件夹，找到<code>.npmrc</code>文件夹，编辑并保存</li></ol><p><code>.npmrc</code>可是个好东西，里面还可以设置<code>node</code>,<code>electron</code>等镜像。</p><h3 id="The-engine-“node”-is-incompatible-with-this-module"><a href="#The-engine-“node”-is-incompatible-with-this-module" class="headerlink" title="The engine “node” is incompatible with this module."></a>The engine “node” is incompatible with this module.</h3><pre><code>error @typescript-eslint/eslint-plugin@2.3.1: The engine &quot;node&quot; is incompatible with this module. Expected version &quot;^8.10.0 || ^10.13.0 || &gt;=11.10.1&quot;.
</code></pre><p>解决方法：</p><ul><li>看提示，node版本不对，升级node到指定版本。</li><li>多<code>node</code>版本，推荐用的<code>nvm</code>来管理<code>node</code>，各种版本随意切换。</li></ul><p>原因</p><ul><li>很简单，试过<code>npm run eject</code>应该知道，那一大堆的配置，可不是简简单单的凑在一起的，很多<code>npm</code>的包都是断崖式的更新，兼容并不美好。所以避免项目启不来，老老实实按官方的提示，来改变本地的<code>node</code>，达到丝滑流畅的体验。</li></ul><h2 id="定制更丝滑的体验"><a href="#定制更丝滑的体验" class="headerlink" title="定制更丝滑的体验"></a>定制更丝滑的体验</h2><h3 id="create-react-app换端口号"><a href="#create-react-app换端口号" class="headerlink" title="create-react-app换端口号"></a><code>create-react-app</code>换端口号</h3><p>默认的3000满足不了，想要自定义，比如10086</p><ul><li>项目根目录创建文件<code>.env</code></li><li>PORT=10086</li><li><code>npm start</code></li><li>完美，打开了10086端口</li></ul><h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><ul><li><a href="https://zh-hans.reactjs.org/" target="_blank" rel="noopener">官方网站，有中文版</a></li><li><a href="https://github.com/facebook/create-react-app/" target="_blank" rel="noopener">github项目源码，开源</a></li></ul></div><div class="post-toc" id="postToc"><div class="toc-outer"><div class="top-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#安装"><span class="toc-number">1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建react应用"><span class="toc-number">2.</span> <span class="toc-text">创建react应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-主要依赖"><span class="toc-number">2.1.</span> <span class="toc-text">1. 主要依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-生成的目录结构"><span class="toc-number">2.2.</span> <span class="toc-text">2. 生成的目录结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-package-json"><span class="toc-number">2.3.</span> <span class="toc-text">3. package.json</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#npm命令"><span class="toc-number">3.</span> <span class="toc-text">npm命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#react-scripts"><span class="toc-number">3.1.</span> <span class="toc-text">react-scripts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#npm-start"><span class="toc-number">3.2.</span> <span class="toc-text">npm start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#npm-run-build"><span class="toc-number">3.3.</span> <span class="toc-text">npm run build</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#npm-run-test"><span class="toc-number">3.4.</span> <span class="toc-text">npm run test</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#npm-run-eject"><span class="toc-number">3.5.</span> <span class="toc-text">npm run eject</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#end"><span class="toc-number">4.</span> <span class="toc-text">end</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#其他"><span class="toc-number">5.</span> <span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#本地调试create-react-app"><span class="toc-number">5.1.</span> <span class="toc-text">本地调试create-react-app</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#查找create-react-app的位置"><span class="toc-number">5.1.1.</span> <span class="toc-text">查找create-react-app的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#找到实际位置"><span class="toc-number">5.1.2.</span> <span class="toc-text">找到实际位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#调试"><span class="toc-number">5.1.3.</span> <span class="toc-text">调试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装中碰到的问题"><span class="toc-number">5.2.</span> <span class="toc-text">安装中碰到的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#巨卡"><span class="toc-number">5.2.1.</span> <span class="toc-text">巨卡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-终端换源"><span class="toc-number">5.2.1.1.</span> <span class="toc-text">1. 终端换源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-配置-npmrc文件，一捞永逸，懒人的福音"><span class="toc-number">5.2.1.2.</span> <span class="toc-text">2.配置.npmrc文件，一捞永逸，懒人的福音</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-engine-“node”-is-incompatible-with-this-module"><span class="toc-number">5.2.2.</span> <span class="toc-text">The engine “node” is incompatible with this module.</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定制更丝滑的体验"><span class="toc-number">5.3.</span> <span class="toc-text">定制更丝滑的体验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#create-react-app换端口号"><span class="toc-number">5.3.1.</span> <span class="toc-text">create-react-app换端口号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相关链接"><span class="toc-number">5.3.2.</span> <span class="toc-text">相关链接</span></a></li></ol></li></ol></li></ol></div></div></div></article><nav id="pagination"><a href="/2018/08/03/http缓存的攻与防/" class="next"><i class="fa fa-angle-right"></i></a></nav></div></div><script src="/js/scripts.js"></script></div></div><script src="/js/scripts.js"></script></body><!-- rebuild by neat -->